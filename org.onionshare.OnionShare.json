{
  "app-id": "org.onionshare.OnionShare",
  "command": "onionshare",
  "runtime": "org.kde.Platform",
  "runtime-version": "5.12",
  "sdk": "org.kde.Sdk",
  "separate-locales": false,
  "finish-args": [
    "--device=dri",
    "--share=ipc",
    "--share=network",
    "--socket=wayland",
    "--socket=x11",
    "--talk-name=org.freedesktop.Flatpak",
    "--talk-name=org.freedesktop.Notifications",
    "--talk-name=org.freedesktop.secrets"
  ],
  "modules": [
    {
      "name": "pyqt5",
      "config-opts": [
        "--disable-static",
        "--enable-x11"
      ],
      "sources": [
        {
          "type": "archive",
          "sha256": "adc17c077bf233987b8e43ada87d1e0deca9bd71a13e5fd5fc377482ed69c827",
          "url": "https://www.riverbankcomputing.com/static/Downloads/PyQt5/5.13.2/PyQt5-5.13.2.tar.gz"
        },
        {
          "type": "script",
          "commands": [
            "python3 configure.py --disable QtBluetooth --disable QtDesigner --disable QtHelp --disable QtLocation --disable QtMacExtras --disable QtNfc --disable QtPositioning --disable QtPrintSupport --disable QtSensors --disable QtSerialPort --disable QtSql --disable QtTest --disable QtWinExtras --assume-shared --confirm-license --no-designer-plugin --no-docstrings --no-qml-plugin --no-tools --destdir ${FLATPAK_DEST}/lib/python3.7/site-packages/ --qsci-api-destdir=${FLATPAK_DEST}/qsci/ --sip=${FLATPAK_DEST}/bin/sip --sip-incdir=${FLATPAK_DEST}/include/ --sipdir=${FLATPAK_DEST}/share/sip/ --stubsdir ${FLATPAK_DEST}/lib/python3.7/site-packages/ --sysroot=${FLATPAK_DEST}/ QMAKE_CFLAGS_RELEASE='-I/usr/include/python3.7m/' QMAKE_CXXFLAGS_RELEASE='-I/usr/include/python3.7m/'"
          ],
          "dest-filename": "configure"
        }
      ],
      "modules": [
        {
          "name": "sip",
          "cleanup": [
            "/bin",
            "/include"
          ],
          "sources": [
            {
              "type": "archive",
              "sha256": "5436b61a78f48c7e8078e93a6b59453ad33780f80c644e5f3af39f94be1ede44",
              "url": "https://www.riverbankcomputing.com/static/Downloads/sip/4.19.19/sip-4.19.19.tar.gz"
            },
            {
              "type": "script",
              "commands": [
                "python3 configure.py --bindir ${FLATPAK_DEST}/bin/ --destdir ${FLATPAK_DEST}/lib/python3.7/site-packages/ --incdir ${FLATPAK_DEST}/include/ --sipdir ${FLATPAK_DEST}/share/sip/ --stubsdir ${FLATPAK_DEST}/lib/python3.7/site-packages/ --sip-module PyQt5.sip"
              ],
              "dest-filename": "configure"
            }
          ]
        }
      ]
    },
    {
      "name": "onionshare",
      "buildsystem": "simple",
      "build-commands": [
        "python3 setup.py install --prefix=${FLATPAK_DEST}",
        "install -D -m0755 onionshare.sh ${FLATPAK_DEST}/bin/onionshare",
        "install -D -m0644 install/org.onionshare.OnionShare.appdata.xml ${FLATPAK_DEST}/share/metainfo/${FLATPAK_ID}.appdata.xml"
      ],
      "sources": [
        {
          "type": "archive",
          "sha256": "0da277c3bfd93c209b9bdab5ff45bdb7ad3d5361fe94e8397fa330067e72e9e1",
          "url": "https://github.com/micahflee/onionshare/archive/910_flatpak.zip"
        },
        {
          "type": "script",
          "commands": [
            "exec /app/bin/onionshare-gui \"$@\""
          ],
          "dest-filename": "onionshare.sh"
        }
      ]
    }
  ]
}