{
  "app-id": "org.onionshare.OnionShare",
  "command": "onionshare",
  "runtime": "org.kde.Platform",
  "runtime-version": "5.12",
  "sdk": "org.kde.Sdk",
  "separate-locales": false,
  "finish-args": [
    "--device=dri",
    "--share=ipc",
    "--share=network",
    "--socket=wayland",
    "--socket=x11",
    "--talk-name=org.freedesktop.Flatpak",
    "--talk-name=org.freedesktop.Notifications",
    "--talk-name=org.freedesktop.secrets"
  ],
  "modules": [
    {
      "name": "pyqt5",
      "config-opts": [
        "--disable-static",
        "--enable-x11"
      ],
      "sources": [
        {
          "type": "archive",
          "sha256": "adc17c077bf233987b8e43ada87d1e0deca9bd71a13e5fd5fc377482ed69c827",
          "url": "https://www.riverbankcomputing.com/static/Downloads/PyQt5/5.13.2/PyQt5-5.13.2.tar.gz"
        },
        {
          "type": "script",
          "commands": [
            "python3 configure.py --disable QtBluetooth --disable QtDesigner --disable QtHelp --disable QtLocation --disable QtMacExtras --disable QtNfc --disable QtPositioning --disable QtPrintSupport --disable QtSensors --disable QtSerialPort --disable QtSql --disable QtTest --disable QtWinExtras --assume-shared --confirm-license --no-designer-plugin --no-docstrings --no-qml-plugin --no-tools --destdir ${FLATPAK_DEST}/lib/python3.7/site-packages/ --qsci-api-destdir=${FLATPAK_DEST}/qsci/ --sip=${FLATPAK_DEST}/bin/sip --sip-incdir=${FLATPAK_DEST}/include/ --sipdir=${FLATPAK_DEST}/share/sip/ --stubsdir ${FLATPAK_DEST}/lib/python3.7/site-packages/ --sysroot=${FLATPAK_DEST}/ QMAKE_CFLAGS_RELEASE='-I/usr/include/python3.7m/' QMAKE_CXXFLAGS_RELEASE='-I/usr/include/python3.7m/'"
          ],
          "dest-filename": "configure"
        }
      ],
      "modules": [
        {
          "name": "sip",
          "cleanup": [
            "/bin",
            "/include"
          ],
          "sources": [
            {
              "type": "archive",
              "sha256": "5436b61a78f48c7e8078e93a6b59453ad33780f80c644e5f3af39f94be1ede44",
              "url": "https://www.riverbankcomputing.com/static/Downloads/sip/4.19.19/sip-4.19.19.tar.gz"
            },
            {
              "type": "script",
              "commands": [
                "python3 configure.py --bindir ${FLATPAK_DEST}/bin/ --destdir ${FLATPAK_DEST}/lib/python3.7/site-packages/ --incdir ${FLATPAK_DEST}/include/ --sipdir ${FLATPAK_DEST}/share/sip/ --stubsdir ${FLATPAK_DEST}/lib/python3.7/site-packages/ --sip-module PyQt5.sip"
              ],
              "dest-filename": "configure"
            }
          ]
        }
      ]
    },
    {
      "name": "onionshare",
      "buildsystem": "simple",
      "build-commands": [
        "python3 setup.py install --prefix=${FLATPAK_DEST}",
        "install -D -m0755 onionshare.sh ${FLATPAK_DEST}/bin/onionshare",
        "install -D -m0644 install/org.onionshare.OnionShare.appdata.xml ${FLATPAK_DEST}/share/metainfo/${FLATPAK_ID}.appdata.xml"
      ],
      "sources": [
        {
          "type": "archive",
          "sha256": "3b9cbbedc6baabb58a409c4e0185a9d91fbcea7adca964532f147c552c61995e",
          "url": "https://github.com/micahflee/onionshare/archive/910_flatpak.zip"
        },
        {
          "type": "script",
          "commands": [
            "exec /app/bin/onionshare-gui \"$@\""
          ],
          "dest-filename": "onionshare.sh"
        }
      ],
      "modules": [
        {
          "name": "python3-Click",
          "buildsystem": "simple",
          "build-commands": [
            "pip3 install --no-index --find-links=\"file://${PWD}\" --prefix=${FLATPAK_DEST} Click"
          ],
          "sources": [
            {
              "type": "file",
              "url": "https://files.pythonhosted.org/packages/fa/37/45185cb5abbc30d7257104c434fe0b07e5a195a6847506c074527aa599ec/Click-7.0-py2.py3-none-any.whl",
              "sha256": "2335065e6395b9e67ca716de5f7526736bfa6ceead690adf616d925bdc622b13"
            }
          ]
        },
        {
          "name": "python3-Flask",
          "buildsystem": "simple",
          "build-commands": [
            "pip3 install --no-index --find-links=\"file://${PWD}\" --prefix=${FLATPAK_DEST} Flask"
          ],
          "sources": [
            {
              "type": "file",
              "url": "https://files.pythonhosted.org/packages/b9/2e/64db92e53b86efccfaea71321f597fa2e1b2bd3853d8ce658568f7a13094/MarkupSafe-1.1.1.tar.gz",
              "sha256": "29872e92839765e546828bb7754a68c418d927cd064fd4708fab9fe9c8bb116b"
            },
            {
              "type": "file",
              "url": "https://files.pythonhosted.org/packages/ce/42/3aeda98f96e85fd26180534d36570e4d18108d62ae36f87694b476b83d6f/Werkzeug-0.16.0-py2.py3-none-any.whl",
              "sha256": "e5f4a1f98b52b18a93da705a7458e55afb26f32bff83ff5d19189f92462d65c4"
            },
            {
              "type": "file",
              "url": "https://files.pythonhosted.org/packages/fa/37/45185cb5abbc30d7257104c434fe0b07e5a195a6847506c074527aa599ec/Click-7.0-py2.py3-none-any.whl",
              "sha256": "2335065e6395b9e67ca716de5f7526736bfa6ceead690adf616d925bdc622b13"
            },
            {
              "type": "file",
              "url": "https://files.pythonhosted.org/packages/65/e0/eb35e762802015cab1ccee04e8a277b03f1d8e53da3ec3106882ec42558b/Jinja2-2.10.3-py2.py3-none-any.whl",
              "sha256": "74320bb91f31270f9551d46522e33af46a80c3d619f4a4bf42b3164d30b5911f"
            },
            {
              "type": "file",
              "url": "https://files.pythonhosted.org/packages/76/ae/44b03b253d6fade317f32c24d100b3b35c2239807046a4c953c7b89fa49e/itsdangerous-1.1.0-py2.py3-none-any.whl",
              "sha256": "b12271b2047cb23eeb98c8b5622e2e5c5e9abd9784a153e9d8ef9cb4dd09d749"
            },
            {
              "type": "file",
              "url": "https://files.pythonhosted.org/packages/9b/93/628509b8d5dc749656a9641f4caf13540e2cdec85276964ff8f43bbb1d3b/Flask-1.1.1-py2.py3-none-any.whl",
              "sha256": "45eb5a6fd193d6cf7e0cf5d8a5b31f83d5faae0293695626f539a823e93b13f6"
            }
          ]
        },
        {
          "name": "python3-Flask-HTTPAuth",
          "buildsystem": "simple",
          "build-commands": [
            "pip3 install --no-index --find-links=\"file://${PWD}\" --prefix=${FLATPAK_DEST} Flask-HTTPAuth"
          ],
          "sources": [
            {
              "type": "file",
              "url": "https://files.pythonhosted.org/packages/b9/2e/64db92e53b86efccfaea71321f597fa2e1b2bd3853d8ce658568f7a13094/MarkupSafe-1.1.1.tar.gz",
              "sha256": "29872e92839765e546828bb7754a68c418d927cd064fd4708fab9fe9c8bb116b"
            },
            {
              "type": "file",
              "url": "https://files.pythonhosted.org/packages/76/ae/44b03b253d6fade317f32c24d100b3b35c2239807046a4c953c7b89fa49e/itsdangerous-1.1.0-py2.py3-none-any.whl",
              "sha256": "b12271b2047cb23eeb98c8b5622e2e5c5e9abd9784a153e9d8ef9cb4dd09d749"
            },
            {
              "type": "file",
              "url": "https://files.pythonhosted.org/packages/65/e0/eb35e762802015cab1ccee04e8a277b03f1d8e53da3ec3106882ec42558b/Jinja2-2.10.3-py2.py3-none-any.whl",
              "sha256": "74320bb91f31270f9551d46522e33af46a80c3d619f4a4bf42b3164d30b5911f"
            },
            {
              "type": "file",
              "url": "https://files.pythonhosted.org/packages/ce/42/3aeda98f96e85fd26180534d36570e4d18108d62ae36f87694b476b83d6f/Werkzeug-0.16.0-py2.py3-none-any.whl",
              "sha256": "e5f4a1f98b52b18a93da705a7458e55afb26f32bff83ff5d19189f92462d65c4"
            },
            {
              "type": "file",
              "url": "https://files.pythonhosted.org/packages/fa/37/45185cb5abbc30d7257104c434fe0b07e5a195a6847506c074527aa599ec/Click-7.0-py2.py3-none-any.whl",
              "sha256": "2335065e6395b9e67ca716de5f7526736bfa6ceead690adf616d925bdc622b13"
            },
            {
              "type": "file",
              "url": "https://files.pythonhosted.org/packages/9b/93/628509b8d5dc749656a9641f4caf13540e2cdec85276964ff8f43bbb1d3b/Flask-1.1.1-py2.py3-none-any.whl",
              "sha256": "45eb5a6fd193d6cf7e0cf5d8a5b31f83d5faae0293695626f539a823e93b13f6"
            },
            {
              "type": "file",
              "url": "https://files.pythonhosted.org/packages/b9/fd/89fc9aa163b5a7aa809fac0835502c2b66f48a5114a73df7e2a104cc645f/Flask_HTTPAuth-3.3.0-py2.py3-none-any.whl",
              "sha256": "0149953720489407e51ec24bc2f86273597b7973d71cd51f9443bd0e2a89bd72"
            }
          ]
        },
        {
          "name": "python3-stem",
          "buildsystem": "simple",
          "build-commands": [
            "pip3 install --no-index --find-links=\"file://${PWD}\" --prefix=${FLATPAK_DEST} stem"
          ],
          "sources": [
            {
              "type": "file",
              "url": "https://files.pythonhosted.org/packages/7f/71/d82f4204e88be00220cc54eedb2972fd05081cb0e5ebdc537d8940b064ea/stem-1.7.1.tar.gz",
              "sha256": "c9eaf3116cb60c15995cbd3dec3a5cbc50e9bb6e062c4d6d42201e566f498ca2"
            }
          ]
        },
        {
          "name": "python3-pycryptodome",
          "buildsystem": "simple",
          "build-commands": [
            "pip3 install --no-index --find-links=\"file://${PWD}\" --prefix=${FLATPAK_DEST} pycryptodome"
          ],
          "sources": [
            {
              "type": "file",
              "url": "https://files.pythonhosted.org/packages/2a/f4/dd7f09f4635962b0283bd8020d686e5ced9e4f05259cab8d7926c696bee1/pycryptodome-3.9.4.tar.gz",
              "sha256": "a168e73879619b467072509a223282a02c8047d932a48b74fbd498f27224aa04"
            }
          ]
        },
        {
          "name": "python3-PySocks",
          "buildsystem": "simple",
          "build-commands": [
            "pip3 install --no-index --find-links=\"file://${PWD}\" --prefix=${FLATPAK_DEST} PySocks"
          ],
          "sources": [
            {
              "type": "file",
              "url": "https://files.pythonhosted.org/packages/8d/59/b4572118e098ac8e46e399a1dd0f2d85403ce8bbaad9ec79373ed6badaf9/PySocks-1.7.1-py3-none-any.whl",
              "sha256": "2725bd0a9925919b9b51739eea5f9e2bae91e83288108a9ad338b2e3a4435ee5"
            }
          ]
        },
        {
          "name": "python3-requests",
          "buildsystem": "simple",
          "build-commands": [
            "pip3 install --no-index --find-links=\"file://${PWD}\" --prefix=${FLATPAK_DEST} requests"
          ],
          "sources": [
            {
              "type": "file",
              "url": "https://files.pythonhosted.org/packages/b4/40/a9837291310ee1ccc242ceb6ebfd9eb21539649f193a7c8c86ba15b98539/urllib3-1.25.7-py2.py3-none-any.whl",
              "sha256": "a8a318824cc77d1fd4b2bec2ded92646630d7fe8619497b142c84a9e6f5a7293"
            },
            {
              "type": "file",
              "url": "https://files.pythonhosted.org/packages/14/2c/cd551d81dbe15200be1cf41cd03869a46fe7226e7450af7a6545bfc474c9/idna-2.8-py2.py3-none-any.whl",
              "sha256": "ea8b7f6188e6fa117537c3df7da9fc686d485087abf6ac197f9c46432f7e4a3c"
            },
            {
              "type": "file",
              "url": "https://files.pythonhosted.org/packages/bc/a9/01ffebfb562e4274b6487b4bb1ddec7ca55ec7510b22e4c51f14098443b8/chardet-3.0.4-py2.py3-none-any.whl",
              "sha256": "fc323ffcaeaed0e0a02bf4d117757b98aed530d9ed4531e3e15460124c106691"
            },
            {
              "type": "file",
              "url": "https://files.pythonhosted.org/packages/18/b0/8146a4f8dd402f60744fa380bc73ca47303cccf8b9190fd16a827281eac2/certifi-2019.9.11-py2.py3-none-any.whl",
              "sha256": "fd7c7c74727ddcf00e9acd26bba8da604ffec95bf1c2144e67aff7a8b50e6cef"
            },
            {
              "type": "file",
              "url": "https://files.pythonhosted.org/packages/51/bd/23c926cd341ea6b7dd0b2a00aba99ae0f828be89d72b2190f27c11d4b7fb/requests-2.22.0-py2.py3-none-any.whl",
              "sha256": "9cf5292fcd0f598c671cfc1e0d7d1a7f13bb8085e9a590f48c010551dc6c4b31"
            }
          ]
        }
      ]
    }
  ]
}